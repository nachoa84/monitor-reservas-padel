name: ü§ñ Monitor Reservas P√°del

on:
  schedule:
    # MI√âRCOLES - Noche (Argentina 21:50-23:59)
    - cron: '50 0 * * 4'    # Mi√© 21:50 ARG = Jue 00:50 UTC
    - cron: '0 1 * * 4'     # Mi√© 22:00 ARG = Jue 01:00 UTC
    - cron: '10 1 * * 4'    # Mi√© 22:10 ARG = Jue 01:10 UTC
    - cron: '20 1 * * 4'    # Mi√© 22:20 ARG = Jue 01:20 UTC
    - cron: '30 1 * * 4'    # Mi√© 22:30 ARG = Jue 01:30 UTC
    - cron: '40 1 * * 4'    # Mi√© 22:40 ARG = Jue 01:40 UTC
    - cron: '50 1 * * 4'    # Mi√© 22:50 ARG = Jue 01:50 UTC
    - cron: '0 2 * * 4'     # Mi√© 23:00 ARG = Jue 02:00 UTC
    
    # JUEVES - Ma√±ana (Argentina 06:00-08:00)
    - cron: '0 9 * * 4'     # Jue 06:00 ARG = Jue 09:00 UTC
    - cron: '15 9 * * 4'    # Jue 06:15 ARG = Jue 09:15 UTC
    - cron: '30 9 * * 4'    # Jue 06:30 ARG = Jue 09:30 UTC
    - cron: '45 9 * * 4'    # Jue 06:45 ARG = Jue 09:45 UTC
    - cron: '0 10 * * 4'    # Jue 07:00 ARG = Jue 10:00 UTC
  
  workflow_dispatch:

jobs:
  monitor:
    runs-on: ubuntu-latest
    
    steps:
    - name: ‚¨áÔ∏è Descargar c√≥digo
      uses: actions/checkout@v3
    
    - name: üêç Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: üì¶ Instalar dependencias Python
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install selenium webdriver-manager chromedriver-binary-auto
    
    - name: üåê Configurar Chrome
      run: |
        sudo apt-get update
        # Instalar Chrome
        wget -q -O - https://dl.google.com/linux/linux_signing_key.pub | sudo gpg --dearmor -o /usr/share/keyrings/google-chrome.gpg
        echo "deb [arch=amd64 signed-by=/usr/share/keyrings/google-chrome.gpg] http://dl.google.com/linux/chrome/deb/ stable main" | sudo tee /etc/apt/sources.list.d/google-chrome.list
        sudo apt-get update
        sudo apt-get install -y google-chrome-stable
        
        # Verificar instalaci√≥n
        echo "Chrome version:"
        google-chrome --version
        
    - name: ü§ñ Ejecutar Monitor
      env:
        TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        USUARIO_CLUB: ${{ secrets.USUARIO_CLUB }}
        PASSWORD_CLUB: ${{ secrets.PASSWORD_CLUB }}
      run: python monitor.py
